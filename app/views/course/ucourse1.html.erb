<% course = @course %>

<div class="course-detail-page">
  <div class="course-detail-container">
    <div class="course-detail-header">
      <h1 class="course-detail-title"><%= course.name %></h1>
    </div>

    <div class="course-detail-image">
      <%= image_tag rails_blob_url(course.image), alt: course.name %>
    </div>

    <div class="course-detail-content">
      <%= course.description.html_safe %>

      <p style="margin-top: 2rem;">
        <strong>Course code:</strong> <%= course.cname %>
      </p>

      <%= course.more.html_safe %>

      <% if @user_regd > 0 %>
        <div class="registration-status">
          ‚úì You are registered for this course
        </div>

        <div class="lecture-links">
          <h3>üìö Lecture Links</h3>
          <% if course.yt.present? %>
            <ul>
              <% course.yt.split("\n").each do |link| %>
                <% lecture = link.split(": ") %>
                <li>
                  <%= lecture[0] %>: 
                  <%= link_to lecture[1], lecture[1], target: "_blank" %>
                </li>
              <% end %>
            </ul>
          <% else %>
            <p>Coming soon.</p>
          <% end %>
        </div>

        <div class="exam-list">
          <h3>üìù Exams</h3>
          <ul>
            <% @exams.select { |e| e.name.include?(course.cname) }.each do |exam| %>
              <% exam_parts = exam.name.split("_") %>
              <% type = exam.etype ? "Self Evaluation Quiz" : "Main Exam" %>
              <li>
                <%= link_to exam_uview_path(course.cname, exam_parts[0] + "_" + exam_parts[1]) do %>
                  <%= "#{type} - #{exam_parts[1]} | #{exam_parts[2]}" %>
                <% end %>
              </li>
            <% end %>
          </ul>
        </div>

      <% elsif course.regon == "off" %>
        <div class="registration-closed">
          ‚ö† Registration has been closed for this course
        </div>

      <% else %>
        <div style="text-align: center; margin-top: 2rem;">
          <%= link_to course_reg_path(course.cname), 
                      class: "btn-edit",
                      style: "display: inline-flex; width: 200px; margin: 0 auto;",
                      data: { confirm: "Are you sure you want to register for this course?" } do %>
            <span class="btn-icon">‚úì</span>
            Register Now
          <% end %>
        </div>
      <% end %>
    </div>

    <div class="back-button">
      <%= link_to courses_path, class: "btn-secondary" do %>
        ‚Üê ‡§™‡•ç‡§∞‡§§‡§ø‡§ó‡§ö‡•ç‡§õ‡§§‡•Å
      <% end %>
    </div>
  </div>
</div>