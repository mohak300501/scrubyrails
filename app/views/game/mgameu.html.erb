<div class="form-page">
  <div class="form-container">
    <div class="form-header">
      <div class="greeting">рдирдорд╕реНрддреЗ ЁЯЩП</div>
      <h1>рдХреНрд░реАрдбрд╛рдВ рдкрд░рд┐рд╡рд░реНрддрдпрддреБ</h1>
      <p class="form-subtitle">рдХреНрд░реАрдбрд╛рдпрд╛рдГ рд╡рд┐рд╡рд░рдгрдВ рдирд╡реАрдХрд░реЛрддреБ</p>
    </div>

    <%= form_for @game, url: game_update_path, html: { multipart: true, class: "modern-form" } do |f| %>
      <div class="form-group">
        <%= f.label :name, "рд╢реАрд░реНрд╖рдХрдВ", class: "form-label" %>
        <%= f.text_field :name, required: true, class: "form-input", placeholder: "рдХреНрд░реАрдбрд╛рдпрд╛рдГ рдирд╛рдо..." %>
      </div>

      <div class="form-group">
        <%= f.label :info, "рдХреНрд░реАрдбрд╛", class: "form-label" %>
        <%= f.text_area :info, required: true, class: "form-textarea", placeholder: "рдХреНрд░реАрдбрд╛рдпрд╛рдГ рд╡рд┐рд╡рд░рдгрдВ рд▓рд┐рдЦрддреБ...", rows: 6 %>
      </div>

      <div class="form-group">
        <%= f.label :image, "рдЪрд┐рддреНрд░рдореН", class: "form-label" %>
        
        <% if @game.image.attached? %>
          <div class="current-image">
            <%= image_tag @game.image, alt: @game.name, style: "max-width: 100%; height: auto; border-radius: 8px; margin-bottom: 1rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1);" %>
            <p style="color: #5a6c7d; font-size: 0.9rem; margin-top: 0.5rem;">рд╡рд░реНрддрдорд╛рдирдВ рдЪрд┐рддреНрд░рдореН</p>
          </div>
        <% end %>

        <div class="file-input-wrapper">
          <%= f.file_field :image, class: "file-input", id: "game-image-input", accept: "image/*" %>
          <label for="game-image-input" class="file-input-label">
            <i class="upload-icon">ЁЯУБ</i>
            <span id="image-file-name">рдирд╡реАрдирдВ рдЪрд┐рддреНрд░рдВ рдЪрд┐рдиреЛрддреБ (рд╡реИрдХрд▓реНрдкрд┐рдХрдореН)</span>
          </label>
        </div>
        <div id="image-preview" class="file-preview"></div>
      </div>

      <div class="form-actions">
        <%= f.submit "рдирд╡реАрдХрд░реЛрддреБ", class: "btn btn-primary" %>
        <%= link_to "рдкреНрд░рддрд┐рдЧрдЪреНрдЫрддреБ", all_games_path, class: "btn btn-secondary" %>
      </div>
    <% end %>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
  const fileInput = document.getElementById('game-image-input');
  const fileNameDisplay = document.getElementById('image-file-name');
  const imagePreview = document.getElementById('image-preview');
  
  fileInput.addEventListener('change', function() {
    if (this.files && this.files.length > 0) {
      const fileName = this.files[0].name;
      fileNameDisplay.textContent = fileName;
      
      // Show image preview
      const reader = new FileReader();
      reader.onload = function(e) {
        imagePreview.innerHTML = `
          <img src="${e.target.result}" alt="Preview" style="max-width: 100%; height: auto; border-radius: 8px; margin-top: 1rem; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
        `;
      };
      reader.readAsDataURL(fileInput.files[0]);
    } else {
      fileNameDisplay.textContent = 'рдирд╡реАрдирдВ рдЪрд┐рддреНрд░рдВ рдЪрд┐рдиреЛрддреБ (рд╡реИрдХрд▓реНрдкрд┐рдХрдореН)';
      imagePreview.innerHTML = '';
    }
  });
});
</script>